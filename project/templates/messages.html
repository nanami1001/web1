{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                {% for category, message in messages %}
                    let icon = 'info';
                    {% if category == 'success' %}
                        icon = 'success';
                    {% elif category in ['error', 'danger'] %}
                        icon = 'error';
                    {% elif category == 'warning' %}
                        icon = 'warning';
                    {% endif %}
                    
                    Swal.fire({
                        title: '{{ message }}',
                        icon: icon,
                        toast: true,
                        position: 'top-end',
                        showConfirmButton: false,
                        timer: 3000,
                        timerProgressBar: true,
                        customClass: {
                            popup: 'colored-toast'
                        },
                        didOpen: (toast) => {
                            toast.addEventListener('mouseenter', Swal.stopTimer)
                            toast.addEventListener('mouseleave', Swal.resumeTimer)
                        }
                    });
                {% endfor %}
            });
        </script>
    {% endif %}
{% endwith %}